---
title:  'Component Design'
author: 'Opshell'
createdAt: '2024/08/27'
categories: 'Web Application'
tags:
  - Web Application
editLink: true
isPublished: false
---


我今天是教到寫元件，我範例是寫個delete button,click會先confirm,使用者按確定時，才會觸發delete-click

我以前有一陣子很喜歡寫綁業務邏輯的 UI
後來發現效應很低⋯⋯
我乾脆「直白的」寫

有時候適當的複製貼上和不封裝其實更好維護

當大型團隊協作時
最有共用價值的是不包含業務邏輯的元件
那種有業務邏輯的⋯⋯
它會動，就不要動⋯⋯
你不會想要重構或維護，更不要說版本管理

有一件事很重要
最近的體悟
凡是共用就要版本管理
不想版本管理就不要共用

版本管理不是上 git
而是「每一次發生變更」都是一個版本
都要進行「向下相容」和「依賴管理」

其實初期蠻難理解我知道
等大家有機會碰到大型架構的重構與迭代慢慢可以感受

後來我就不會很追求共用
而是分離

寫的直白點其實更好閱讀
而且分離好可以避免改 A壞 B
做好解耦避免依賴循環

Vue 搭配 slot 可以大量減少元件深度，不需要一層層往下找

以前寫 Vue 時
我通常不會讓專案出現超過4層的深度

Page
Container
Section
Atomic

這幾層很夠用了
一隻檔案行數多一點沒關係
分層清楚、有拆 Composable 就很夠了

回頭看看共用⋯⋯
好像好處除了
開發快一點⋯⋯
Code 少一點⋯⋯
產生更多問題⋯⋯

恩  前陣子
專案升級的時候也在想這個問題
不管是套件、自己做的component、composable
除非可重用性有超過90~95%
不然我都先弄一個新的
寧願降低耦合
不嫌麻煩先多做
不然、之後需求有調整的時候
會改得很想死
等穩定了在考慮 優化重構的部分

不然我都先弄一個新的
寧願降低耦合
不嫌麻煩先多做
不然、之後需求有調整的時候
會改得很想死
等穩定了在考慮 優化重構的部分

以前我也很愛把差不多的東西
包在一起共用
覺得 乾淨 漂亮

然後需求調整
別人幫我代班
隕石掉下來

OK  世界毀滅吧~


世界末日的時候
城市蓋的漂亮沒用
隕石落下，全毀

做好分區隔離，分艙隔離
隕石來了，壞了就拋棄，蓋新的就好



至於上面提到個共用。最近一年的體悟最大的感受

1. 所謂的共用應該強調的是易用性而不是可以少寫 code 就好
2. 在易用的大前提下，產品專案內部的共用都是動態的且可能是迭代速度與幅度是相對快速的，不要抱持著久久更新一次的認知來處理共用，應該要為專案的共用區分層級
3. 上述兩點前提下，共用原則與共識就很重要，不然你會發現專案一大堆同事各自的共用手法，某種程度上來說反而讓專案變更髒更難用
4. 共用的前提是解藕，共用區塊應該要盡可能減少狀態處理，除非狀態的生命週期已經非常成熟，不然真的是複製貼上才不會突然天外飛來 bug 單

最後.............IDE功能很好用。資料夾分層管理很好用。
稍微研究一下可以讓專案變大的時候幸福很多，我後來發現真的很多人連工具都不熟。

反而因為這樣增加專案管理難度 Orz...



福大
其實認真說，你要能快速對應隨時可能有隕石的狀況就是要這樣:

1. 不要太快封裝功能正常但可能有相似邏輯的組件
2. 先求功能寫完、運作正常，不要把時間都花在程式碼好看，但要邏輯清楚
3. 專案架構的組件深度不要超過三層 (我自己不想超過三層)
4. 隨時記錄技術債的存在點
關於4.的意思就是你可以記錄迫於時間壓力、特定需求讓你很無奈必須妥協的那些東西






簡單的話可能會是組件樣式共用或是資料共用或是共用範圍。

例如 甲組件只會在 A Page 內部共用，那怎麼去調整這個共用的檔案存放位置一類的問題就要好好思考一下。

因為我家專案就有碰過只共用在 A Page 但卻放在 global 層級，檔案命名也沒處理好導致後面的人沒分清楚直接動手改下去炸爛同事
也有都不管共用性質直接 import 拿來亂用後面的需求一改莫名其妙接 bug 單的也有




應該是說
盡量不要把不太一樣的東西
包在一個共用邏輯裡面

比方說  可能有個函式
會產出一個固定格式的物件

但是輸入的接口
確可以接 很多不同格式的資料
甚至是 吃特定組件的狀態

這樣會讓這個函式耦合很重

用組件粗暴一點的說就是把東西處理好再 prop 給子層，不要打一堆狀態進去子層處理
不然就會發現美其名曰是寫共用。但實際上是開了一支檔案寫窮舉 lol

一大堆條件渲染維護起來很恐怖


